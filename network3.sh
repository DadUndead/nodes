channel_logo() {
  echo -e '\033[0;31m'
  echo -e '‚îå‚îê ‚îå‚îÄ‚îê‚îå‚îÄ‚îê‚îå‚îÄ‚îê‚îå‚î¨‚îê‚î¨‚î¨ ‚î¨  ‚îå‚îÄ‚îê‚î¨ ‚î¨‚îå‚îê ‚î¨‚î¨  '
  echo -e '‚îú‚î¥‚îê‚îÇ ‚îÇ‚îÇ ‚î¨‚îú‚îÄ‚î§ ‚îÇ ‚îÇ‚îî‚î¨‚îò  ‚îî‚îÄ‚îê‚îî‚î¨‚îò‚îú‚î¥‚îê‚îÇ‚îÇ  '
  echo -e '‚îî‚îÄ‚îò‚îî‚îÄ‚îò‚îî‚îÄ‚îò‚î¥ ‚î¥ ‚î¥ ‚î¥ ‚î¥   ‚îî‚îÄ‚îò ‚î¥ ‚îî‚îÄ‚îò‚î¥‚î¥‚îÄ‚îò'
  echo -e '\e[0m'
  echo -e "\n\n–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ —Å–∞–º—ã–π 4ekHyTbIu* –∫–∞–Ω–∞–ª –≤ –∫—Ä–∏–ø—Ç–µ @bogatiy_sybil [üí∏]"
}

download_node() {
  echo '–ù–∞—á–∏–Ω–∞—é —É—Å—Ç–∞–Ω–æ–≤–∫—É...'

  cd $HOME

  sudo apt install lsof

  ports=(1433 8080)

  for port in "${ports[@]}"; do
    if [[ $(lsof -i :"$port" | wc -l) -gt 0 ]]; then
      echo "–û—à–∏–±–∫–∞: –ü–æ—Ä—Ç $port –∑–∞–Ω—è—Ç. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —Å–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è."
      exit 1
    fi
  done

  sudo apt update -y && sudo apt upgrade -y

  sudo dpkg --configure -a

  sudo apt install screen net-tools iptables jq curl -y

  wget https://network3.io/ubuntu-node-v2.1.1.tar.gz
  tar -xvf ubuntu-node-v2.1.1.tar.gz
  sudo rm -rf ubuntu-node-v2.1.1.tar.gz

  cd ubuntu-node

  screen -S network3
}

launch_node() {
  cd $HOME/ubuntu-node
  sudo bash manager.sh up
}

stop_node() {
  cd $HOME/ubuntu-node
  sudo bash manager.sh down
}

check_points() {
  my_ip=$(hostname -I | awk '{print $1}')
  total_points=$(curl -s http://$my_ip:8080/detail | jq '.earnings.total')
  echo -e "–£ –≤–∞—Å —Å—Ç–æ–ª—å–∫–æ –ø–æ–∏–Ω—Ç–æ–≤: $total_points"
}

check_private_key() {
  cd $HOME/ubuntu-node
  sudo bash manager.sh key
}

update_node() {
  cd $HOME/ubuntu-node
  sudo bash manager.sh key

  read -p '(!) –°–û–•–†–ê–ù–ò–ï –í–ê–® –ü–†–ò–í–ê–¢–ù–´–ô –ö–õ–Æ–ß –í –ù–ê–î–ï–ñ–ù–û–ú –ú–ï–°–¢–ï, –ö–ê–ö –≠–¢–û –°–î–ï–õ–ê–ï–¢–ï, –í–í–ï–î–ò–¢–ï –õ–Æ–ë–û–ô –°–ò–ú–í–û–õ: ' checkjust

  cd $HOME
  sudo rm -r ubuntu-node

  wget https://network3.io/ubuntu-node-v2.1.1.tar.gz
  tar -xvf ubuntu-node-v2.1.1.tar.gz
  sudo rm -rf ubuntu-node-v2.1.1.tar.gz


  screen -S network3 -X stuff "cd ubuntu-node$(printf \\r)sudo bash manager.sh up$(printf \\r)"
}

exit_from_script() {
  exit 0
}

while true; do
    channel_logo
    sleep 2
    echo -e "\n\n–ú–µ–Ω—é:"
    echo "1. üîß –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–¥—É"
    echo "2. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–¥—É"
    echo "3. ‚õî –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–¥—É"
    echo "4. üéØ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∏–Ω—Ç–æ–≤"
    echo "5. üîë –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á"
    echo "6. üíª –û–±–Ω–æ–≤–∏—Ç—å –Ω–æ–¥—É"
    echo -e "7. ‚ùå –í—ã–π—Ç–∏ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞\n"
    read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é: " choice

    case $choice in
      1)
        download_node
        ;;
      2)
        launch_node
        ;;
      3)
        stop_node
        ;;
      4)
        check_points
        ;;
      5)
        check_private_key
        ;;
      6)
        update_node
        ;;
      7)
        exit_from_script
        ;;
      *)
        echo "–ù–µ–≤–µ—Ä–Ω—ã–π –ø—É–Ω–∫—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ü–∏—Ñ—Ä—É –≤ –º–µ–Ω—é."
        ;;
    esac
  done
